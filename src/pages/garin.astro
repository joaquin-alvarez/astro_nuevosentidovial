---
import Layout from '../layouts/Layout.astro';
import LeafletMap from '../components/LeafletMap.astro';
import { getMapDataForLocation } from '../data/geoJsonAdapter.js';

// Obtener datos filtrados para Garín (excluyendo las colectoras)
const streets = getMapDataForLocation('Garín', false);

// Calcular centro basado en las calles
function calculateCenter(streets) {
  if (streets.length === 0) return [-34.417, -58.730]; // Valor por defecto para Garín
  
  let totalLat = 0;
  let totalLng = 0;
  let pointCount = 0;
  
  streets.forEach(street => {
    street.coordinates.forEach(coord => {
      totalLat += coord[0]; // latitud
      totalLng += coord[1]; // longitud
      pointCount++;
    });
  });
  
  return [totalLat / pointCount, totalLng / pointCount];
}

const center = calculateCenter(streets);
const zoom = 15;
---

<Layout title="Garín - Cambios de sentido de calles">
	<section>
		<LeafletMap 
			mapId="mapa-garin" 
			locationName="Garín"
			centerLat={center[0]}
			centerLng={center[1]}
			initialZoom={zoom}
			mapData={streets || []}
		/>
		<h2>Garín</h2>
		<p>
			El plan redefine sentidos de circulación en el área central para mejorar la conexión entre el Boulevard Presidente Perón, 
			la Colectora Oeste y las calles más transitadas. También establece normas de estacionamiento y nueva señalización, 
			con el objetivo de reducir los cruces conflictivos y ordenar los accesos.
		</p>

		<h3>Calles que cambian de sentido y pasan a tener sentido único:</h3>
		<ul class="street-list">
			<li>
				<strong>Sarmiento</strong>
				<span class="street-category street-change">Cambio de sentido</span>
				<p>Tramo: de Blvd. Pres. Perón a Colectora Oeste</p>
				<p>Nueva dirección: desde el inicio hacia el final del tramo</p>
				<span class="direction-info">Sentido único</span>
			</li>
			<li>
				<strong>General Las Heras</strong>
				<span class="street-category street-change">Cambio de sentido</span>
				<p>Tramo: entre Colectora Oeste y Blvd. Pres. Perón</p>
				<p>Nueva dirección: desde el inicio hacia el final del tramo</p>
				<span class="direction-info">Sentido único</span>
			</li>
			<li>
				<strong>Alvear</strong>
				<span class="street-category street-change">Cambio de sentido</span>
				<p>Tramo: de Lamberti a Colectora Oeste</p>
				<p>Nueva dirección: desde el inicio hacia el final del tramo</p>
				<span class="direction-info">Sentido único</span>
			</li>
			<li>
				<strong>Mitre</strong>
				<span class="street-category street-change">Cambio de sentido</span>
				<p>Tramo: entre Colectora Oeste y Cabo 1º Sullings</p>
				<p>Nueva dirección: desde el inicio hacia el final del tramo</p>
				<span class="direction-info">Sentido único</span>
			</li>
			<li>
				<strong>Eva Perón</strong>
				<span class="street-category street-change">Cambio de sentido</span>
				<p>Tramo: de 2 de Abril a Buenos Aires</p>
				<p>Nueva dirección: desde el inicio hacia el final del tramo</p>
				<span class="direction-info">Sentido único</span>
			</li>
			<li>
				<strong>Roma</strong>
				<span class="street-category street-change">Cambio de sentido</span>
				<p>Tramo: entre Buenos Aires y 2 de Abril</p>
				<p>Nueva dirección: desde el inicio hacia el final del tramo</p>
				<span class="direction-info">Sentido único</span>
			</li>
			<li>
				<strong>Padre Perna</strong>
				<span class="street-category street-change">Cambio de sentido</span>
				<p>Tramo: de 2 de Abril a Buenos Aires</p>
				<p>Nueva dirección: desde el inicio hacia el final del tramo</p>
				<span class="direction-info">Sentido único</span>
			</li>
			<li>
				<strong>Cabo 1º Sullings</strong>
				<span class="street-category street-change">Cambio de sentido</span>
				<p>Tramo: de 2 de Abril a Buenos Aires</p>
				<p>Nueva dirección: desde el inicio hacia el final del tramo</p>
				<span class="direction-info">Sentido único</span>
			</li>
			<li>
				<strong>Cabo 1º Sullings</strong>
				<span class="street-category double-way">Doble sentido</span>
				<p>Tramo: entre Jorge Testa y Mitre</p>
				<p>Modificación: pasa a tener doble sentido de circulación</p>
				<span class="direction-info">Doble mano</span>
			</li>
			<li>
				<strong>Lamberti</strong>
				<span class="street-category street-change">Cambio de sentido</span>
				<p>Tramo: de Buenos Aires a 2 de Abril</p>
				<p>Nueva dirección: desde el inicio hacia el final del tramo</p>
				<span class="direction-info">Sentido único</span>
			</li>
			<li>
				<strong>Inocencio Arias</strong>
				<span class="street-category street-change">Cambio de sentido</span>
				<p>Tramo: entre 2 de Abril y Sarmiento</p>
				<p>Nueva dirección: desde el inicio hacia el final del tramo</p>
				<span class="direction-info">Sentido único</span>
			</li>
			<li>
				<strong>Ballester</strong>
				<span class="street-category street-change">Cambio de sentido</span>
				<p>Tramo: de Sarmiento a Buenos Aires</p>
				<p>Nueva dirección: desde el inicio hacia el final del tramo</p>
				<span class="direction-info">Sentido único</span>
			</li>
		</ul>

		<h3>Detalles de los cambios de sentido</h3>
		<p>A continuación se presenta información adicional sobre las zonas afectadas y objetivos de los cambios de circulación en Garín.</p>
		
		<div class="street-changes-details">
			<h4>Zonas de intervención</h4>
			<ul class="area-list">
				<li><strong>Sector céntrico:</strong> Principalmente las calles transversales entre Buenos Aires y el Blvd. Presidente Perón (Sarmiento, General Las Heras, Eva Perón, Roma, Padre Perna).</li>
				<li><strong>Corredor de Colectora Oeste:</strong> Se modificó la circulación en las calles que conectan con la colectora (Alvear, Mitre, Cabo 1º Sullings) para organizar los flujos de entrada y salida.</li>
				<li><strong>Corredor 2 de Abril:</strong> Calles que cruzan esta importante avenida han sido reorganizadas para mejorar la circulación.</li>
			</ul>

			<h4>Beneficios del nuevo esquema</h4>
			<ul class="benefits-list">
				<li><strong>Reducción de cruces conflictivos:</strong> Se eliminan puntos de cruce con alta tasa de accidentes.</li>
				<li><strong>Mejora de la fluidez:</strong> El sistema de calles paralelas con sentidos opuestos facilita la circulación.</li>
				<li><strong>Mayor seguridad peatonal:</strong> Las calles de sentido único permiten instalar cruces peatonales más seguros.</li>
				<li><strong>Optimización del estacionamiento:</strong> Se reorganiza el estacionamiento permitido en diferentes calles.</li>
			</ul>
		</div>

		<div class="info-box">
			<h4>Información importante</h4>
			<p>
				Estos cambios buscan mejorar la fluidez del tránsito y aumentar la seguridad vial en la zona céntrica de Garín.
				Se recomienda a los conductores prestar atención a la nueva señalización instalada en las calles afectadas.
			</p>
		</div>
	</section>
</Layout>

<style>
	.street-changes-details {
		margin: 2rem 0;
		padding: 1.5rem;
		border: 1px solid var(--bg-dark);
		border-radius: var(--radius);
		background-color: var(--bg-card);
		box-shadow: var(--shadow);
	}

	.street-changes-details h4 {
		color: var(--accent-dark);
		margin-bottom: 1rem;
		font-size: 1.15rem;
	}

	.area-list,
	.benefits-list {
		list-style-type: disc;
		padding-left: 1.5rem;
		margin-bottom: 1.5rem;
	}

	.area-list li,
	.benefits-list li {
		margin-bottom: 0.75rem;
		line-height: 1.5;
	}

	.benefits-list li strong {
		color: var(--accent-dark);
	}

	.info-box {
		background-color: #e2f0fd;
		border-left: 4px solid var(--accent);
		padding: 1rem;
		margin: 2rem 0;
		border-radius: 0 0.5rem 0.5rem 0;
	}

	.info-box h4 {
		color: var(--accent-dark);
		margin-bottom: 0.5rem;
	}

	@media (max-width: 768px) {
		.street-list {
			grid-template-columns: 1fr;
		}
	}
</style>

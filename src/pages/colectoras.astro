---
import Layout from '../layouts/Layout.astro';
import LeafletMap from '../components/LeafletMap.astro';
import { getMapDataForLocation } from '../data/geoJsonAdapter.ts';
import type { Street } from '../data/types';
import { StreetUtils } from '../data/types';

// Obtener datos filtrados para colectoras de Belén de Escobar
const belenStreets: Street[] = getMapDataForLocation('Belén de Escobar', true);

// Valores por defecto para Belén de Escobar (colectoras)
const belenDefaultCenter: [number, number] = [-34.342, -58.810];

// Usar la clase de utilidad para calcular el centro
const belenCenter = StreetUtils.calculateCenter(belenStreets, belenDefaultCenter);
const belenZoom = 14;

// Obtener datos filtrados para colectoras de Garín
const garinStreets: Street[] = getMapDataForLocation('Garín', true);

// Valores por defecto para Garín (colectoras)
const garinDefaultCenter: [number, number] = [-34.417, -58.730];

// Usar la clase de utilidad para calcular el centro
const garinCenter = StreetUtils.calculateCenter(garinStreets, garinDefaultCenter);
const garinZoom = 15;
---

<Layout title="Cambios en Colectoras - Cambios de sentido de calles">
	<section>
		<h2>Cambios en las Colectoras</h2>
		<p>
			Los cambios en las colectoras buscan mejorar la seguridad vial y la fluidez del tránsito en puntos críticos 
			de las diferentes localidades.
		</p>

		<div class="colectora-maps-container">
			<div class="colectora-map-section">
				<h3>Colectoras en Belén de Escobar</h3>
				<div class="colectora-map">
					<LeafletMap 
						mapId="mapa-colectoras-belen" 
						locationName="Belén de Escobar - Colectoras"
						centerLat={belenCenter[0]}
						centerLng={belenCenter[1]}
						initialZoom={belenZoom}
						mapData={belenStreets || []}
						showLegend={false}
					/>
				</div>
			</div>

			<div class="colectora-map-section">
				<h3>Colectoras en Garín</h3>
				<div class="colectora-map">
					<LeafletMap 
						mapId="mapa-colectoras-garin" 
						locationName="Garín - Colectoras"
						centerLat={garinCenter[0]}
						centerLng={garinCenter[1]}
						initialZoom={garinZoom}
						mapData={garinStreets || []}
						showLegend={false}
					/>
				</div>
			</div>
		</div>

		<div class="collector-section">
			<h3>Belén de Escobar</h3>
			<p>
				En Belén, la colectora Este (avenida De los Inmigrantes) mantendrá el doble sentido entre Spadaccini y Las Casuarinas, 
				mientras que desde Las Casuarinas hasta la unión con Docente Serantes de Álvarez será mano única.
			</p>
			<p>
				En la colectora Oeste, el doble sentido se limitará al tramo comprendido entre Artigas y César Díaz; 
				en ese sector pasará a tener sentido único hacia el sur.
			</p>
		</div>

		<div class="collector-section">
			<h3>Garín</h3>
			<p>
				En Garín, la colectora Oeste conservará doble sentido entre Mendoza y General Las Heras, pero será mano única 
				desde Corrientes hasta Mendoza y desde General Las Heras hasta la avenida Belgrano.
			</p>
			<p>
				Además, otras dos calles que la interceptan también cambian su sentido: Tucumán será mano única desde colectora 
				hasta H. Yrigoyen sentido este-oeste y Corrientes único sentido de H. Yrigoyen hasta Colectora Oeste, sentido oeste-este.
			</p>
		</div>

		<div class="info-box">
			<h4>Objetivo de los cambios</h4>
			<div class="info-content">
				<i class='bx bxs-info-circle info-icon'></i>
				<p>
					La finalidad de estos cambios es evitar la doble circulación en las colectoras que pasan por debajo de los puentes 
					de Inmigrantes y El Curvón, puntos de alto flujo y riesgo vial.
				</p>
			</div>
		</div>

		<h3>Detalle de cambios en colectoras</h3>

		<h4>Colectoras en Belén de Escobar</h4>
		<div class="street-changes-details">
			<ul class="street-list">
				<li>
					<strong>Colectora Este (Av. De los Inmigrantes)</strong>
					<span class="street-category double-way">Doble sentido</span>
					<p>Tramo: entre Spadaccini y Las Casuarinas</p>
					<p>Se mantiene: Doble sentido de circulación</p>
					<span class="direction-info">Doble mano</span>
				</li>
				<li>
					<strong>Colectora Este (Av. De los Inmigrantes)</strong>
					<span class="street-category collector-change">Cambio en colectora</span>
					<p>Tramo: desde Las Casuarinas hasta Docente Serantes de Álvarez</p>
					<p>Nueva dirección: circulación en un solo sentido</p>
					<span class="direction-info">Sentido único</span>
				</li>
				<li>
					<strong>Colectora Oeste</strong>
					<span class="street-category double-way">Doble sentido</span>
					<p>Tramo: entre Artigas y César Díaz</p>
					<p>Se mantiene: Doble sentido de circulación</p>
					<span class="direction-info">Doble mano</span>
				</li>
				<li>
					<strong>Colectora Oeste</strong>
					<span class="street-category collector-change">Cambio en colectora</span>
					<p>Tramo: después de César Díaz</p>
					<p>Nueva dirección: circulación en un solo sentido</p>
					<span class="direction-info">Sentido único</span>
				</li>
			</ul>
		</div>
		
		<h4>Colectoras en Garín</h4>
		<div class="street-changes-details">
			<ul class="street-list">
				<li>
					<strong>Colectora Oeste (Garín)</strong>
					<span class="street-category double-way">Doble sentido</span>
					<p>Tramo: entre Mendoza y General Las Heras</p>
					<p>Se mantiene: Doble sentido de circulación</p>
					<span class="direction-info">Doble mano</span>
				</li>
				<li>
					<strong>Colectora Oeste (Garín)</strong>
					<span class="street-category collector-change">Cambio en colectora</span>
					<p>Tramo: desde Corrientes hasta Mendoza</p>
					<p>Nueva dirección: circulación en un solo sentido</p>
					<span class="direction-info">Sentido único</span>
				</li>
				<li>
					<strong>Colectora Oeste (Garín)</strong>
					<span class="street-category collector-change">Cambio en colectora</span>
					<p>Tramo: desde General Las Heras hasta la avenida Belgrano</p>
					<p>Nueva dirección: circulación en un solo sentido</p>
					<span class="direction-info">Sentido único</span>
				</li>
				<li>
					<strong>Tucumán</strong>
					<span class="street-category street-change">Cambio de sentido</span>
					<p>Tramo: desde colectora hasta H. Yrigoyen</p>
					<p>Nueva dirección: desde colectora hacia H. Yrigoyen</p>
					<span class="direction-info">Sentido único</span>
				</li>
				<li>
					<strong>Corrientes</strong>
					<span class="street-category street-change">Cambio de sentido</span>
					<p>Tramo: de H. Yrigoyen hasta Colectora Oeste</p>
					<p>Nueva dirección: desde H. Yrigoyen hacia Colectora Oeste</p>
					<span class="direction-info">Sentido único</span>
				</li>
			</ul>
		</div>
		
		<div class="info-note">
			<div class="note-content">
				<i class='bx bx-shield-quarter note-icon'></i>
				<div>
					<p>
						Los cambios en las colectoras están diseñados para mejorar la seguridad vial en puntos críticos, 
						especialmente en los pasos bajo puentes y en intersecciones de alto tránsito.
					</p>
					<p>
						Se recomienda a los conductores prestar especial atención a la nueva señalización instalada 
						en estos tramos para evitar confusiones y garantizar una circulación segura.
					</p>
				</div>
			</div>
		</div>
	</section>
</Layout>

<style>
	.collector-section {
		margin-bottom: 2rem;
		padding-bottom: 1rem;
		border-bottom: 1px solid var(--bg-dark);
	}

	.collector-section:last-of-type {
		border-bottom: none;
	}

	.colectora-maps-container {
		display: flex;
		flex-direction: column;
		gap: 2rem;
		margin: 2rem 0;
	}

	.colectora-map-section {
		display: flex;
		flex-direction: column;
		gap: 1rem;
	}

	.colectora-map-section h3 {
		margin-bottom: 0.5rem;
		color: var(--accent-dark);
		font-size: 1.3rem;
	}

	.colectora-map {
		height: 400px;
		width: 100%;
		border-radius: var(--radius);
		overflow: hidden;
		box-shadow: var(--shadow);
	}

	@media (min-width: 768px) {
		.colectora-maps-container {
			flex-direction: row;
		}

		.colectora-map-section {
			flex: 1;
		}
	}

	.info-box {
		background-color: rgba(30, 136, 229, 0.08);
		border-left: var(--card-border-width) solid var(--accent);
		padding: 1.5rem;
		margin: 2.25rem 0;
		border-radius: 0 var(--radius) var(--radius) 0;
		box-shadow: var(--shadow);
		position: relative;
		transition: var(--transition);
	}

	.info-box:hover {
		transform: translateY(-4px);
		box-shadow: var(--shadow-hover);
	}

	.info-box h4 {
		color: var(--accent-dark);
		font-family: 'Outfit', sans-serif;
		margin-bottom: 0.75rem;
		font-size: 1.2rem;
		font-weight: 600;
	}

	.info-content {
		display: flex;
		align-items: flex-start;
		gap: 1rem;
	}

	.info-icon {
		color: var(--accent);
		font-size: 1.5rem;
		margin-top: 0.25rem;
	}
	
	.info-note {
		background-color: #f8fafc;
		border: 1px solid var(--bg-dark);
		border-radius: var(--radius);
		padding: 1.5rem;
		margin: 2rem 0;
		box-shadow: var(--shadow);
		transition: var(--transition);
		border-top: var(--card-border-width) solid var(--green);
	}

	.info-note:hover {
		transform: translateY(-4px);
		box-shadow: var(--shadow-hover);
	}

	.note-content {
		display: flex;
		align-items: flex-start;
		gap: 1rem;
	}

	.note-icon {
		color: var(--green);
		font-size: 1.5rem;
		margin-top: 0.25rem;
	}

	.info-note p:last-child {
		margin-bottom: 0;
	}

	h3 {
		margin-top: 1.5rem;
		color: var(--accent-dark);
		margin-bottom: 1rem;
	}

	.street-changes-details {
		margin: 1.5rem 0 2.5rem;
	}

	@media (max-width: 768px) {
		.street-list {
			grid-template-columns: 1fr;
		}
	}
	/* Hide legends for Colectoras maps */	
	:global(#mapa-colectoras-belen .map-legend),
	:global(#mapa-colectoras-garin .map-legend) {
		display: none !important;
	}
</style>
